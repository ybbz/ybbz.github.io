<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>





<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Linux," />





  <link rel="alternate" href="/atom.xml" title="八宝粥的博客" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="配置SSH服务SSH作为Linux远程连接重要的方式，如何配置安装linux系统的SSH服务?
1.在终端输入以下命令，查找当前系统是否已经安装ssh服务
rpm -qa |grep ssh
2.如果没有安装SSH软件包，可以通过进行安装
yum install ssh
sudo apt-get install openssh-server   #Ubuntu等
3.安装好了之后，开启ssh服务">
<meta property="og:type" content="article">
<meta property="og:title" content="我在新服务器配置上走过的那些坑(2)">
<meta property="og:url" content="http://blog.ybbz.site/2016/03/18/server-configuration-2/index.html">
<meta property="og:site_name" content="八宝粥的博客">
<meta property="og:description" content="配置SSH服务SSH作为Linux远程连接重要的方式，如何配置安装linux系统的SSH服务?
1.在终端输入以下命令，查找当前系统是否已经安装ssh服务
rpm -qa |grep ssh
2.如果没有安装SSH软件包，可以通过进行安装
yum install ssh
sudo apt-get install openssh-server   #Ubuntu等
3.安装好了之后，开启ssh服务">
<meta property="og:updated_time" content="2016-07-12T02:05:48.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我在新服务器配置上走过的那些坑(2)">
<meta name="twitter:description" content="配置SSH服务SSH作为Linux远程连接重要的方式，如何配置安装linux系统的SSH服务?
1.在终端输入以下命令，查找当前系统是否已经安装ssh服务
rpm -qa |grep ssh
2.如果没有安装SSH软件包，可以通过进行安装
yum install ssh
sudo apt-get install openssh-server   #Ubuntu等
3.安装好了之后，开启ssh服务">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 6231437225821734000,
      author: 'Author'
    }
  };
</script>

  <title> 我在新服务器配置上走过的那些坑(2) | 八宝粥的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?bf48638c9f88aa67b7f9a0135affb55a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">八宝粥的博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">这一切都是命运石之门的选择</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                我在新服务器配置上走过的那些坑(2)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-18T00:00:00+08:00" content="2016-03-18">
              2016-03-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/18/server-configuration-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/18/server-configuration-2/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/03/18/server-configuration-2/" class="leancloud_visitors" data-flag-title="我在新服务器配置上走过的那些坑(2)">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="配置SSH服务"><a href="#配置SSH服务" class="headerlink" title="配置SSH服务"></a>配置SSH服务</h3><p>SSH作为Linux远程连接重要的方式，如何配置安装linux系统的SSH服务?</p>
<p>1.在终端输入以下命令，查找当前系统是否已经安装ssh服务</p>
<pre><code>rpm -qa |grep ssh
</code></pre><p>2.如果没有安装SSH软件包，可以通过进行安装</p>
<pre><code>yum install ssh
sudo apt-get install openssh-server   #Ubuntu等
</code></pre><p>3.安装好了之后，开启ssh服务</p>
<pre><code>service sshd start
/etc/init.d/sshd start   #二选一
</code></pre><p>4.配置好ssh服务，就可以远程登录Linux系统了</p>
<pre><code>ssh username@ip  ＃username：用户名；ip：服务器ip
</code></pre><h3 id="安装Python3-5"><a href="#安装Python3-5" class="headerlink" title="安装Python3.5"></a>安装Python3.5</h3><p>1.下载python3.5的包</p>
<p>在python官网<a href="https://www.python.org/downloads/release/python-351/" target="_blank" rel="external">https://www.python.org/downloads/release/python-351/</a> 下载tgz包（Python-3.5.1.tgz）</p>
<p>2.解压文件，并进入目录</p>
<pre><code>tar -xf Python-3.5.1.tgz
cd Python-3.5.1
</code></pre><p>4.开始安装，使用编译的方法进行安装</p>
<pre><code>mkdir /usr/python3.5
./configure --prefix=/usr/python3.5
make
make install
</code></pre><p>5.让系统默认使用Python3.5.1（慎用！可能会对系统自带的python2.7造成影响……）</p>
<pre><code>cd /usr/bin
mv python python.bak
ln -s /usr/python3.5/bin/python3 /usr/bin/python
</code></pre><p>6.系统找不到python3/pip3命令，可通过如下方式解决</p>
<pre><code>ln -s /usr/python3.5/bin/python3 /usr/bin/python3
ln -s /usr/python3.5/bin/pip3 /usr/bin/pip3
</code></pre><h3 id="重启网络服务"><a href="#重启网络服务" class="headerlink" title="重启网络服务"></a>重启网络服务</h3><pre><code>service network restart
</code></pre><h3 id="修改DNS配置"><a href="#修改DNS配置" class="headerlink" title="修改DNS配置"></a>修改DNS配置</h3><pre><code>vi /etc/resolv.conf
</code></pre><h3 id="yum源问题"><a href="#yum源问题" class="headerlink" title="yum源问题"></a>yum源问题</h3><p>DNS或者IPV6的问题（校园网用户略坑）</p>
<h3 id="urlopen-error-unknown-url-type-https"><a href="#urlopen-error-unknown-url-type-https" class="headerlink" title="urlopen error unknown url type: https"></a>urlopen error unknown url type: https</h3><p>在网上找到了这个<a href="https://support.serverdensity.com/hc/en-us/articles/201670413-urlopen-error-unknown-url-type-https" target="_blank" rel="external">解决方案</a>，同时也参考了该<a href="http://blog.csdn.net/zyz511919766/article/details/25049365" target="_blank" rel="external">博客</a></p>
<blockquote>
<p>This happens if your system does not have SSL installed with Python. You need to recompile Python with SSL on:<br>Steps:<br>1.Download and install OpenSSL, if you don’t have it already.<br>2.Download Python source and rebuild Python (the usual steps of configure, make and make install). Python’s configure script should be able to pick up your existing SSL libraries automatically and build a shared library -ssl.so.</p>
<p>也就是说：python内置的urllib模块不支持https协议，是因为编译安装python之前没有编译安装类似于openssl这样的SSL库。因此需要安装openssl-devel，之后再重新编译Python。</p>
</blockquote>
<pre><code>sudo yum install openssl-devel
./configure --prefix=/usr/python3.5
make
make install
</code></pre><h3 id="配置LAMP"><a href="#配置LAMP" class="headerlink" title="配置LAMP"></a>配置LAMP</h3><pre><code>yum install httpd -y    #安装apache服务
yum install mariadb -y  #安装Mariadb(代替MySQL)
yum install php -y      #安装PHP
systemctl start httpd   #启动apache服务
#在浏览器地址栏输入localhost即可看到测试界面
</code></pre><table>
<thead>
<tr>
<th>任务</th>
<th style="text-align:center">指令</th>
</tr>
</thead>
<tbody>
<tr>
<td>使某服务自动启动</td>
<td style="text-align:center">systemctl enable httpd.service</td>
</tr>
<tr>
<td>使某服务不自动启动</td>
<td style="text-align:center">systemctl disable httpd.service</td>
</tr>
<tr>
<td>检查服务状态</td>
<td style="text-align:center">systemctl status httpd.service （服务详细信息）</td>
</tr>
<tr>
<td></td>
<td style="text-align:center">systemctl is-active httpd.service （仅显示是否 Active)</td>
</tr>
<tr>
<td>显示所有已启动的服务</td>
<td style="text-align:center">systemctl list-units –type=service</td>
</tr>
<tr>
<td>启动某服务</td>
<td style="text-align:center">systemctl start httpd.service</td>
</tr>
<tr>
<td>停止某服务</td>
<td style="text-align:center">systemctl stop httpd.service</td>
</tr>
<tr>
<td>重启某服务</td>
<td style="text-align:center">systemctl restart httpd.service</td>
</tr>
</tbody>
</table>
<p>Apache虚拟主机配置(参考另一篇文章：CentOS7配置Apache多站点VirtualHost)</p>
<h3 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h3><pre><code>#无法访问Apache服务器，可能是防火墙的原因
systemctl stop firewalld.service      #停止
systemctl disable firewalld.service   #禁用
</code></pre><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><pre><code>#复制文件夹
cp -Rf /root/user/python1 /var/www/python2     #python1目录复制到python2目录下
cp -Rf /root/user/python1/* /var/www/python2/  #不复制python1目录本身

＃文件权限（目录以及其子目录下的所有文件，所有用户及群组，写权限）
chmod -R a+w /usr/share/nginx/html   
#chmod命令详解:http://www.cnblogs.com/peida/archive/2012/11/29/2794010.html
</code></pre><h3 id="查看Apache版本信息"><a href="#查看Apache版本信息" class="headerlink" title="查看Apache版本信息"></a>查看Apache版本信息</h3><pre><code>httpd -v
apachectl -v   #二选一
</code></pre><h3 id="CentOS7安装MariaDB（更新）"><a href="#CentOS7安装MariaDB（更新）" class="headerlink" title="CentOS7安装MariaDB（更新）"></a>CentOS7安装MariaDB（更新）</h3><p>1.安装MariaDB</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install mariadb mariadb-server #询问是否要安装，输入Y即可自动安装,直到安装完成</span><br><span class="line">systemctl start mariadb<span class="selector-class">.service</span> #启动MariaDB</span><br><span class="line">systemctl stop mariadb<span class="selector-class">.service</span> #停止MariaDB</span><br><span class="line">systemctl restart mariadb<span class="selector-class">.service</span> #重启MariaDB</span><br><span class="line">systemctl enable mariadb<span class="selector-class">.service</span> #设置开机启动</span><br><span class="line">cp /usr/share/mysql/my-huge<span class="selector-class">.cnf</span> /etc/my<span class="selector-class">.cnf</span> #拷贝配置文件（注意：如果/etc目录下面默认有一个my.cnf，直接覆盖即可）</span><br></pre></td></tr></table></figure>
<p>2.为root账户设置密码</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql_secure_installation</span><br><span class="line">回车，根据提示输入Y</span><br><span class="line">输入<span class="number">2</span>次密码，回车</span><br><span class="line">根据提示一路输入Y</span><br><span class="line">最后出现：Thanks <span class="built_in">for</span> <span class="keyword">using</span> MySQL!</span><br><span class="line">MySql密码设置完成，重新启动 MySQL：</span><br><span class="line">systemctl restart mariadb.service <span class="meta">#重启MariaDB</span></span><br></pre></td></tr></table></figure>
<h3 id="端口占用问题"><a href="#端口占用问题" class="headerlink" title="端口占用问题"></a>端口占用问题</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fuser -n tcp 8080</span><br><span class="line"><span class="built_in">kill</span> -9 *****</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div>
      
        
<div id="wechat_subscriber" style="display: block； padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/images/qrcode.jpg" alt="八宝粥 wechat" style="width: 200px; max-width: 100%;"/>
    <div>欢迎您扫一扫上面的微信公众号，订阅我的博客！</div>
</div>

      
    </div>

    <div>
      
        
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Linux/" rel="tag">#Linux</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/03/18/server-configuration-1/" rel="next" title="我在新服务器配置上走过的那些坑(1)">
                <i class="fa fa-chevron-left"></i> 我在新服务器配置上走过的那些坑(1)
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/03/19/Python-shell-ipython/" rel="prev" title="Python增强交互式shell：ipython">
                Python增强交互式shell：ipython <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2016/03/18/server-configuration-2/"
     data-title="我在新服务器配置上走过的那些坑(2)"
     data-content=""
     data-url="http://blog.ybbz.site/2016/03/18/server-configuration-2/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/03/18/server-configuration-2/"
           data-title="我在新服务器配置上走过的那些坑(2)" data-url="http://blog.ybbz.site/2016/03/18/server-configuration-2/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="八宝粥" />
          <p class="site-author-name" itemprop="name">八宝粥</p>
          <p class="site-description motion-element" itemprop="description">这一切都是命运石之门的选择</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">105</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">67</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ybbz" target="_blank" title="GitHub">
                  
                    <i class="fa fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/1005955131" target="_blank" title="Weibo">
                  
                    <i class="fa fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/ba-bao-zhou-73" target="_blank" title="Zhihu">
                  
                    <i class="fa fa-star"></i>
                  
                  Zhihu
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://segmentfault.com/u/ybbz" target="_blank" title="SegmentFault">
                  
                    <i class="fa fa-star"></i>
                  
                  SegmentFault
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#配置SSH服务"><span class="nav-number">1.</span> <span class="nav-text">配置SSH服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装Python3-5"><span class="nav-number">2.</span> <span class="nav-text">安装Python3.5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重启网络服务"><span class="nav-number">3.</span> <span class="nav-text">重启网络服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改DNS配置"><span class="nav-number">4.</span> <span class="nav-text">修改DNS配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#yum源问题"><span class="nav-number">5.</span> <span class="nav-text">yum源问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#urlopen-error-unknown-url-type-https"><span class="nav-number">6.</span> <span class="nav-text">urlopen error unknown url type: https</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置LAMP"><span class="nav-number">7.</span> <span class="nav-text">配置LAMP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关闭防火墙"><span class="nav-number">8.</span> <span class="nav-text">关闭防火墙</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用命令"><span class="nav-number">9.</span> <span class="nav-text">常用命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看Apache版本信息"><span class="nav-number">10.</span> <span class="nav-text">查看Apache版本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CentOS7安装MariaDB（更新）"><span class="nav-number">11.</span> <span class="nav-text">CentOS7安装MariaDB（更新）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#端口占用问题"><span class="nav-number">12.</span> <span class="nav-text">端口占用问题</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">八宝粥</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"babaozhou"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
      
      <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
      <script src="/js/src/hook-duoshuo.js"></script>
    
  





  
  
  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("xKIXPQjqdy6UtStIi4iDbH8J-gzGzoHsz", "P2fn57Oe1oP1KAHUrFRnWpSH");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
